<!DOCTYPE html>
<html lang="en" itemscope="" itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8" />

  <title>Prevent Hash DoS in python · Saurabh Kumar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" user-scalable="no">

  <meta name="author" content="Saurabh Kumar">
  <meta name="copyright" content="Saurabh Kumar">

<meta name="description" content="How can you prevent denial of service attacks in python if you are using python &lt;= 3">
<meta name="date" content="2013-09-01 12:00:00+05:30">

<meta name="keywords" content="python, security, programming, " />
<link rel="author" href=https://plus.google.com/+SaurabhKumar0/>  <meta name="twitter:creator" content="@_theskumar">
  <meta name="twitter:site" content="@_theskumar">

<meta itemprop="name" content="Prevent Hash DoS in python ">
<meta property="og:title" content="Prevent Hash DoS in python "/>
<meta property="og:url" content="https://saurabh-kumar.com/blog/hash-dos-in-python.html">
<meta property="og:description" content="How can you prevent denial of service attacks in python if you are using python &lt;= 3">
<meta property="og:site_name" content="Saurabh Kumar">
<meta property="og:article:author" content="Saurabh Kumar">
 <meta property="og:article:published_time" content="2013-09-01T12:00:00+05:30"><meta name="twitter:title" content="Prevent Hash DoS in python ">
<meta name="twitter:description" content="How can you prevent denial of service attacks in python if you are using python &lt;= 3">
<meta name="twitter:card" content="summary">




  <link rel="stylesheet" href="https://saurabh-kumar.com/blog/theme/css/main.f.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">


  <link href="https://saurabh-kumar.com/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Saurabh Kumar Full Atom Feed" />

</head>

<body class=" article page-single  programming">

    <header>
        <div class='site_info'>
          <a href="https://saurabh-kumar.com/blog" class='logo'>
                <img src="https://1.gravatar.com/avatar/fc974e2829eac6e3512a9d7f82e04723?s=160" alt="logo">
          </a>
          <div class="info">
            <h2><a href="https://saurabh-kumar.com/blog">Saurabh Kumar</a></h2>
            <p>Thoughts and Writings</p>
          </div>
        </div>

        <div class="subscribe">
            <a class="subscribe-button icon-feed" href="https://saurabh-kumar.com/blog/feeds/all.atom.xml">Subscribe</a>
        </div>
    </header>

    <main role=main>
<article itemscope itemtype="http://schema.org/BlogPosting" class='blogPosting'>
    <div id="article_title" class='title blogPosting-title'>
        <h1 itemprop="headline">Prevent Hash DoS in&nbsp;python</h1>
        <time datetime="2013-09-01 12:00:00+05:30" itemprop="datePublished">Sun 01 September 2013</time>.

    </div>
  <div id="article_text" itemprop="articleBody" class='blogPosting-text'>
    <blockquote class="twitter-tweet"><p>$ export <span class="caps">PYTHONHASHSEED</span>=random &#10;&#10;Makes hashes of types unpredictable across <a href="https://twitter.com/search?q=%23python&amp;src=hash">#python</a> invocations, making your app more secure to <span class="caps">DOS</span>&nbsp;attacks.</p>&mdash; Anand B Pillai (@pythonhacker) <a href="https://twitter.com/pythonhacker/statuses/375671280394989568">September 5, 2013</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>Denial of Service through hash table multi-collisions or <a class="reference external" href="https://web.archive.org/web/20131016035929/http://www.purehacking.com/blogs/josh-zlatin/introduction-to-hash-dos-attacks">Hash DoS</a> has been
first reported in 28-Dec-2011 <a class="footnote-reference" href="#id4" id="id1">[1]</a>.</p>
<p>Python and Ruby are partially vulnerable, depending on version or whether the server
running the code is a 32 bit or 64 bit machine. Python 2 by default does not provide
random value for <tt class="docutils literal"><span class="caps">PYTHONHASHSEED</span></tt> <a class="footnote-reference" href="#id5" id="id2">[2]</a> though it&#8217;s behaviour is changed in
python 3 <a class="footnote-reference" href="#id6" id="id3">[3]</a> which means it has <tt class="docutils literal">random</tt> as it default&nbsp;value.</p>
<div class="section" id="references">
<h2>References</h2>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="https://web.archive.org/web/20140606214923/https://www.nruns.com/_downloads/advisory28122011.pdf">https://web.archive.org/web/20140606214923/https://www.nruns.com/_downloads/advisory28122011.pdf</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://docs.python.org/2/using/cmdline.html#envvar-PYTHONHASHSEED">http://docs.python.org/2/using/cmdline.html#envvar-<span class="caps">PYTHONHASHSEED</span></a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED">http://docs.python.org/3/using/cmdline.html#envvar-<span class="caps">PYTHONHASHSEED</span></a></td></tr>
</tbody>
</table>
</div>

  </div>
  <style>.promo {
    text-align: left;
    border: 1px solid #E3E5E4;
    background: #F3F4EE;
    padding: 5px 15px;
    position: relative;
    margin-left: 73px;
    margin-top: 20px;
}
.promo img {
    position: absolute;
    left: -67px;
    width: 60px;
    top: -17px;
}
.promo .tweet {
    position: absolute;
    right: 0px;
    top: 4px;
    width: 95px;
}
</style>
<div style="border-bottom: 1px dashed #CCC;">&nbsp;</div>
<div class="promo">
    <img src="http://blog.vjeux.com/wp-content/themes/coogee/images/at-twitter.png" />
    <div class="tweet">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="_theskumar">Tweet</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        </div>
    If you liked this article, you might be interested in my <a href="http://www.twitter.com/_theskumar/" target="_blank">Twitter feed</a> as well.
</div>
<div style="border-bottom: 1px dashed #CCC;">&nbsp;</div>

  <div id="article_meta" class='blogPosting-meta'>
    <p>Category: <a href="https://saurabh-kumar.com/blog/category/programming.html">programming</a>
 Tags:
      <a href="https://saurabh-kumar.com/blog/tag/python.html">python</a>,      <a href="https://saurabh-kumar.com/blog/tag/security.html">security</a>    </p>
  </div>

    <div class='blogPosting-comment' id="article_comments" style="display:block">
        <div id="disqus_thread"></div>
        <script>
            var disqus_identifier = "hash-dos-in-python.html";
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://saurabhkumar.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
    </div>

</article>
    </main>
    <footer>
<p><a href="https://saurabh-kumar.com/blog/" class="button_accent">&larr; Back</a></p>
        <div id="ending_message" class='clearfix'>
            <section class='copyright'>
                <a rel="license" target="blank" href="https://creativecommons.org/licenses/by/4.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
            </section>
            <section class='builtby'>
                Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Saurabh Kumar on <a href="https://github.com/theskumar/pelican-svbtle-responsive" target="_blank">github</a>.
            </section>
        </div>
    </footer>

<script>
function addLink() {
    var body_element = document.getElementsByTagName('body')[0],
        selection = window.getSelection(),
        pagelink = "<br><br>Read more at: <a href='"+document.location.href+"'>"+document.location.href+"</a>",
        copytext = selection + pagelink,
        newdiv = document.createElement('div');
    newdiv.style.position='absolute';
    newdiv.style.left='-99999px';
    body_element.appendChild(newdiv);
    newdiv.innerHTML = copytext;
    selection.selectAllChildren(newdiv);
    window.setTimeout(function() {
        body_element.removeChild(newdiv);
    },0);
}

// register the listener.
document.getElementById('article_text').oncopy = addLink;
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" data-no-instant></script>
  <script src="https://saurabh-kumar.com/blog/theme/js/main.min.js"></script>
  <script data-no-instant>
    InstantClick.init();
  </script>
  <script>
    // initialize fitvids
    $(document).ready(function(){$("body").fitVids();});
  </script>
<script>
    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
    function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
    e=o.createElement(i);r=o.getElementsByTagName(i)[0];
    e.src='https://www.google-analytics.com/analytics.js';
    r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
    ga('create','UA-26681217-2','auto');ga('send','pageview');
</script>
</body>
</html>